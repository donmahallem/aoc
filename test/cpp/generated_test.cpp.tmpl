// Code generated by testgen. DO NOT EDIT.

// Fallback for IDE intellisense; the real value is set by CMake.
#ifndef TEST_DATA_DIR
#define TEST_DATA_DIR ""
#endif

#include <gtest/gtest.h>
#include <sstream>
{{- if .HasFiles}}
#include <fstream>
#include <filesystem>
{{- end}}
{{- if .HasArrayResult}}
#include <vector>
{{- end}}

#include "{{.HeaderPath}}"
{{range .InlineSamples}}
static const std::string {{.VarName}} = R"testgen({{.Input}})testgen";
{{- end}}
{{- if .Part1}}
{{- range .Part1.Samples}}

TEST({{$.TestSuite}}Part1, {{.Name}}) {
    std::istringstream stream({{.VarName}});
    EXPECT_EQ({{$.Namespace}}::Part1(stream), {{.Expected}});
}
{{- end}}
{{- range .Part1.Files}}

TEST({{$.TestSuite}}Part1, {{.Name}}) {
    const std::string path = std::string(TEST_DATA_DIR) + "/{{.FilePath}}";
    if (!std::filesystem::exists(path)) { GTEST_SKIP() << "missing " << path; }
    std::ifstream stream(path);
    EXPECT_EQ({{$.Namespace}}::Part1(stream), {{.Expected}});
}
{{- end}}
{{- end}}
{{- if .Part2}}
{{- range .Part2.Samples}}

TEST({{$.TestSuite}}Part2, {{.Name}}) {
    std::istringstream stream({{.VarName}});
    EXPECT_EQ({{$.Namespace}}::Part2(stream), {{.Expected}});
}
{{- end}}
{{- range .Part2.Files}}

TEST({{$.TestSuite}}Part2, {{.Name}}) {
    const std::string path = std::string(TEST_DATA_DIR) + "/{{.FilePath}}";
    if (!std::filesystem::exists(path)) { GTEST_SKIP() << "missing " << path; }
    std::ifstream stream(path);
    EXPECT_EQ({{$.Namespace}}::Part2(stream), {{.Expected}});
}
{{- end}}
{{- end}}
